<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>💸 Wavy Company</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  body { background: #111; color: #eee; }
  .card { background: #222; color: #eee; }
  .money-gain { position: fixed; left: 50%; top: 50%; transform: translate(-50%, -50%); color: lime; font-size: 2rem; font-weight: bold; opacity: 1; transition: all 1s ease-out; }
</style>
</head>
<body class="p-3">
<h1 class="text-center mb-4">💸 Wavy Company</h1>

<div class="row">
  <div class="col-md-6">
    <div class="card p-3 mb-3">
      <h4>💰 เงิน: $<span id="money">1000</span></h4>
      <h4>🏦 รายได้/วินาที: $<span id="income">5</span></h4>
      <button class="btn btn-primary" onclick="buyBusiness()">ซื้อธุรกิจ (10$)</button>
      <p>จำนวนธุรกิจ: <span id="businessCount">0</span></p>
      <button class="btn btn-primary" onclick="buyProperty()">ซื้ออสังหา (100$)</button>
      <p>จำนวนอสังหา: <span id="propertyCount">0</span></p>
      <button class="btn btn-success" onclick="upgradeMining()">อัปเกรดการขุด ($<span id="upgradeCost">10</span>)</button>
      <p>เลเวลอัปเกรด: <span id="upgradeLevel">1</span></p>
    </div>

    <div class="card p-3 mb-3">
      <h4>📈 หุ้น</h4>
      <button class="btn btn-secondary" onclick="buyStock('wavyBank')">ซื้อ Wavy Bank ($<span id="wavyBankPrice">49</span>)</button>
      <button class="btn btn-secondary" onclick="sellStock('wavyBank')">ขาย Wavy Bank</button>
      <p>Wavy Bank: <span id="wavyBankCount">0</span></p>

      <button class="btn btn-secondary" onclick="buyStock('wavyCompany')">ซื้อ Wavy Company ($<span id="wavyCompanyPrice">500</span>)</button>
      <button class="btn btn-secondary" onclick="sellStock('wavyCompany')">ขาย Wavy Company</button>
      <p>Wavy Company: <span id="wavyCompanyCount">0</span></p>

      <button class="btn btn-secondary" onclick="buyStock('moonTech')">ซื้อ MoonTech ($<span id="moonTechPrice">1000</span>)</button>
      <button class="btn btn-secondary" onclick="sellStock('moonTech')">ขาย MoonTech</button>
      <p>MoonTech: <span id="moonTechCount">0</span></p>
    </div>

    <div class="card p-3">
      <button class="btn btn-success" onclick="saveGame()">💾 บันทึกเกม</button>
      <button class="btn btn-warning" onclick="loadGame()">📂 โหลดเกม</button>
      <button class="btn btn-danger" onclick="resetGame()">🔄 เริ่มใหม่</button>
    </div>
  </div>

  <div class="col-md-6">
    <div class="card p-3 mb-3">
      <h4>📊 กราฟรายได้</h4>
      <canvas id="incomeChart" height="150"></canvas>
    </div>
    <div class="card p-3 mb-3">
      <h4>📊 กราฟปันผล</h4>
      <canvas id="dividendChart" height="150"></canvas>
    </div>
    <div class="card p-3 mb-3">
      <h4>📊 กราฟรวมรายได้+ปันผล</h4>
      <canvas id="totalChart" height="150"></canvas>
    </div>
  </div>
</div>

<script>
let money = 10, income = 10, businessCount = 10, propertyCount = 10;
let upgradeLevel = 1, upgradeCost = 10;
let wavyBankCount = 10, wavyCompanyCount = 10, moonTechCount = 10;
let lastDividend = 10;
const dividendFrequency = 10000;
let stockPrices = { wavyBank: 49, wavyCompany: 500, moonTech: 1000 };

const incomeHistory = [], dividendHistory = [], totalHistory = [];

const ctxIncome = document.getElementById('incomeChart').getContext('2d');
const incomeChart = new Chart(ctxIncome, {
  type: 'line',
  data: { labels: [], datasets: [{ label: 'รายได้', data: [], borderColor: 'cyan', fill: false }] },
  options: { scales: { x: { ticks: { color: '#eee' } }, y: { ticks: { color: '#eee' } } }, plugins: { legend: { labels: { color: '#eee' } } } }
});

const ctxDividend = document.getElementById('dividendChart').getContext('2d');
const dividendChart = new Chart(ctxDividend, {
  type: 'line',
  data: { labels: [], datasets: [{ label: 'ปันผล', data: [], borderColor: 'orange', fill: false }] },
  options: { scales: { x: { ticks: { color: '#eee' } }, y: { ticks: { color: '#eee' } } }, plugins: { legend: { labels: { color: '#eee' } } } }
});

const ctxTotal = document.getElementById('totalChart').getContext('2d');
const totalChart = new Chart(ctxTotal, {
  type: 'line',
  data: { labels: [], datasets: [{ label: 'รวม', data: [], borderColor: 'lime', backgroundColor: 'rgba(0,255,0,0.2)', fill: true }] },
  options: { scales: { x: { ticks: { color: '#eee' } }, y: { ticks: { color: '#eee' } } }, plugins: { legend: { labels: { color: '#eee' } } } }
});

function updateUI() {
  document.getElementById("money").textContent = money.toFixed(2);
  document.getElementById("income").textContent = income.toFixed(2);
  document.getElementById("businessCount").textContent = businessCount;
  document.getElementById("propertyCount").textContent = propertyCount;
  document.getElementById("upgradeLevel").textContent = upgradeLevel;
  document.getElementById("upgradeCost").textContent = upgradeCost;
  document.getElementById("wavyBankCount").textContent = wavyBankCount;
  document.getElementById("wavyCompanyCount").textContent = wavyCompanyCount;
  document.getElementById("moonTechCount").textContent = moonTechCount;
  document.getElementById("wavyBankPrice").textContent = stockPrices.wavyBank.toFixed(2);
  document.getElementById("wavyCompanyPrice").textContent = stockPrices.wavyCompany.toFixed(2);
  document.getElementById("moonTechPrice").textContent = stockPrices.moonTech.toFixed(2);
}

function animateMoneyGain(amount) {
  const anim = document.createElement("div");
  anim.textContent = "+$" + amount.toFixed(2);
  anim.className = "money-gain";
  document.body.appendChild(anim);
  setTimeout(() => { anim.style.transform = "translate(-50%, -200%)"; anim.style.opacity = "0"; }, 10);
  setTimeout(() => { anim.remove(); }, 1000);
}

function buyBusiness() {
  if (money >= 10) { money -= 10; businessCount++; income += 1; updateUI(); }
}
function buyProperty() {
  if (money >= 100) { money -= 100; propertyCount++; income += 10; updateUI(); }
}
function upgradeMining() {
  if (money >= upgradeCost) {
    money -= upgradeCost;
    upgradeLevel++;
    income *= 2;
    upgradeCost *= 2;
    updateUI();
  }
}

function buyStock(stock) {
  if (money >= stockPrices[stock]) {
    money -= stockPrices[stock];
    if (stock === "wavyBank") wavyBankCount++;
    else if (stock === "wavyCompany") wavyCompanyCount++;
    else if (stock === "moonTech") moonTechCount++;
    updateUI();
  }
}
function sellStock(stock) {
  if (stock === "wavyBank" && wavyBankCount > 0) { money += stockPrices.wavyBank; wavyBankCount--; }
  else if (stock === "wavyCompany" && wavyCompanyCount > 0) { money += stockPrices.wavyCompany; wavyCompanyCount--; }
  else if (stock === "moonTech" && moonTechCount > 0) { money += stockPrices.moonTech; moonTechCount--; }
  updateUI();
}

setInterval(() => { money += income; updateIncomeChart(); updateTotalChart(income); animateMoneyGain(income); updateUI(); }, 1000);
setInterval(() => {
  const d1 = wavyBankCount * stockPrices.wavyBank * 0.10;
  const d2 = wavyCompanyCount * stockPrices.wavyCompany * 0.05;
  const d3 = moonTechCount * stockPrices.moonTech * 0.08;
  const totalDividend = d1 + d2 + d3;
  lastDividend = totalDividend;
  money += totalDividend;
  updateDividendChart(totalDividend); updateTotalChart(totalDividend); animateMoneyGain(totalDividend); updateUI();
}, dividendFrequency);
setInterval(() => { ["wavyBank", "wavyCompany", "moonTech"].forEach(s => { stockPrices[s] += (Math.random() - 0.5) * 5; stockPrices[s] = Math.max(1, stockPrices[s]); }); updateUI(); }, 5000);

function updateIncomeChart() {
  const time = new Date().toLocaleTimeString(); incomeHistory.push({ time, value: income }); if (incomeHistory.length > 10) incomeHistory.shift();
  incomeChart.data.labels = incomeHistory.map(i => i.time); incomeChart.data.datasets[0].data = incomeHistory.map(i => i.value); incomeChart.update();
}
function updateDividendChart(dividend) {
  const time = new Date().toLocaleTimeString(); dividendHistory.push({ time, value: dividend }); if (dividendHistory.length > 10) dividendHistory.shift();
  dividendChart.data.labels = dividendHistory.map(i => i.time); dividendChart.data.datasets[0].data = dividendHistory.map(i => i.value); dividendChart.update();
}
function updateTotalChart(total) {
  const time = new Date().toLocaleTimeString(); totalHistory.push({ time, value: total }); if (totalHistory.length > 10) totalHistory.shift();
  totalChart.data.labels = totalHistory.map(i => i.time); totalChart.data.datasets[0].data = totalHistory.map(i => i.value); totalChart.update();
}

function saveGame() { localStorage.setItem('gameData', JSON.stringify({ money, income, businessCount, propertyCount, upgradeLevel, upgradeCost, wavyBankCount, wavyCompanyCount, moonTechCount })); alert("💾 เซฟแล้ว!"); }
function loadGame() { const data = JSON.parse(localStorage.getItem('gameData')); if (data) { Object.assign(window, data); updateUI(); alert("📂 โหลดแล้ว!"); } else alert("ไม่มีข้อมูล!"); }
function resetGame() { if (confirm("⚠️ แน่ใจนะ?")) { money = 0; income = 0; businessCount = 0; propertyCount = 0; upgradeLevel = 1; upgradeCost = 10; wavyBankCount = 0; wavyCompanyCount = 0; moonTechCount = 0; localStorage.removeItem('gameData'); updateUI(); } }
</script>
</body>
</html>
